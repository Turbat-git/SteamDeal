<?xml version="1.0" encoding="utf-8" ?>
<ContentPage 
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui" 
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml" 
    xmlns:viewmodels="clr-namespace:SteamDeal.ViewModels"
    x:Class="SteamDeal.Views.WishlistPage"
    Title="Wishlist"
    BackgroundColor="{DynamicResource PageBackgroundColor}">

    <ContentPage.BindingContext>
        <viewmodels:WishlistViewModel x:Name="ViewModel" />
    </ContentPage.BindingContext>

    <Shell.TitleView>
        <Grid ColumnDefinitions="Auto,*,Auto" Padding="10" VerticalOptions="Center">

            <BoxView WidthRequest="24" HeightRequest="1" Grid.Column="0" IsVisible="False" />

            <ImageButton
            Source="steam_logo.png"
            HeightRequest="28"
            BackgroundColor="Transparent"
            HorizontalOptions="Center"
            VerticalOptions="Center"
            Clicked="OnSteamLogoClicked"
            Grid.Column="1" />

            <ImageButton
            Source="user_icon.png"
            HeightRequest="28"
            WidthRequest="28"
            BackgroundColor="Transparent"
            HorizontalOptions="End"
            VerticalOptions="Center"
            Grid.Column="2" />
        </Grid>
    </Shell.TitleView>

    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="12">

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Label Text="Your Wishlist" 
                       FontSize="24" 
                       FontAttributes="Bold"
                       TextColor="{DynamicResource TextColorPrimary}" 
                       VerticalOptions="Center"
                       Grid.Column="0" />

                <Button Text="Clear All"
                        Command="{Binding ClearWishlistCommand}"
                        BackgroundColor="#FF6B6B"
                        TextColor="White"
                        FontSize="12"
                        Padding="10,5"
                        CornerRadius="6"
                        IsVisible="{Binding IsEmpty, Converter={StaticResource InvertedBoolConverter}}"
                        Grid.Column="1" />
            </Grid>

            <!-- Empty State -->
            <StackLayout IsVisible="{Binding IsEmpty}" 
                         VerticalOptions="CenterAndExpand" 
                         HorizontalOptions="CenterAndExpand"
                         Spacing="20"
                         Margin="0,50,0,0">

                <Label Text="🎮" 
                       FontSize="48" 
                       HorizontalOptions="Center" />

                <Label Text="Your wishlist is empty" 
                       FontSize="18" 
                       FontAttributes="Bold"
                       TextColor="{DynamicResource TextColorPrimary}"
                       HorizontalOptions="Center" />

                <Label Text="Browse games and add them to your wishlist to keep track of deals!" 
                       FontSize="14"
                       TextColor="Gray"
                       HorizontalOptions="Center"
                       HorizontalTextAlignment="Center" />

                <Button Text="Browse Games"
                        Clicked="OnBrowseGamesClicked"
                        BackgroundColor="#4CAF50"
                        TextColor="White"
                        FontSize="16"
                        Padding="20,10"
                        CornerRadius="8"
                        HorizontalOptions="Center" />
            </StackLayout>

            <!-- Wishlist Items -->
            <CollectionView ItemsSource="{Binding WishlistItems}"
                           IsVisible="{Binding IsEmpty, Converter={StaticResource InvertedBoolConverter}}">

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid Padding="0,5">
                            <Frame Padding="12"
                                   Margin="2"
                                   CornerRadius="10"
                                   BackgroundColor="{DynamicResource FrameBackgroundColor}"
                                   BorderColor="#3A3A3A"
                                   HasShadow="True">

                                <Frame.GestureRecognizers>
            </ScrollView>